<!DOCTYPE html>
<html>

<head>
    <title>Verification Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/dark.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <button class="toggle-btn" onclick="toggleDark()">üåô Toggle Dark Mode</button>


    <div class="container">

        <div class="card">
            <h1>üìä Resume Verification Dashboard</h1>
            <h2>Skill Match Score: {{ score }}%</h2>

            {% if score >= 50 %}
            <span class="badge success">GENUINE PROFILE ‚úÖ</span>
            {% else %}
            <span class="badge danger">POSSIBLY FAKE ‚ö†Ô∏è</span>
            {% endif %}

            <a href="/download?score={{ score }}" class="btn">üìÑ Download PDF Report</a>
        </div>

        <div class="card">
            <h2>üìÑ Resume Skills</h2>
            <div class="list">
                {% for skill in resume_skills %}
                <span>{{ skill }}</span>
                {% endfor %}
            </div>
        </div>

        <div class="card">
            <h2>üíª GitHub Detected Skills</h2>
            <div class="list">
                {% for lang in github_languages %}
                <span>{{ lang }}</span>
                {% endfor %}
            </div>
            <p><b>Total Repositories:</b> {{ repos }}</p>
        </div>

        <div class="card">
            <h2>üìà Skill Match Analysis</h2>
            <div class="chart-box">
                <canvas id="skillChart"></canvas>
            </div>
        </div>

        <div class="card">
            <h2>üî• GitHub Daily Activity (Last 30 Days)</h2>
            <div class="chart-box" style="width: 100%; height: 300px;">
                <canvas id="contributionChart"></canvas>
            </div>
        </div>

    </div>

    </div>

    <script>
        const ctx = document.getElementById('skillChart');

        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Matched Skills', 'Unmatched Skills'],
                datasets: [{
                    data: [{{ score }}, {{ 100 - score }}],
            backgroundColor: ['#2ecc71', '#e74c3c']
        }]
            },
            options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
        });

        // Contribution Chart
        const contributionCtx = document.getElementById('contributionChart').getContext('2d');
        const contributionData = {{ contribution_levels | tojson }};

        new Chart(contributionCtx, {
            type: 'line',
            data: {
                labels: Array.from({ length: contributionData.length }, (_, i) => i + 1),
                datasets: [{
                    label: 'Activity Level',
                    data: contributionData,
                    borderColor: '#2ecc71',
                    backgroundColor: 'rgba(46, 204, 113, 0.2)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 3
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 4,
                        ticks: {
                            stepSize: 1
                        },
                        title: {
                            display: true,
                            text: 'Level (0-4)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Days ago'
                        }
                    }
                }
            }
        });
    </script>

    <script>
        function toggleDark() {
            document.body.classList.toggle("dark");
        }
    </script>

    {% if resume_skills|length > 0 and github_languages|length > 0 %}
    <div class="card">
        <h2>üìä Skill Comparison</h2>
        <div class="chart-box">
            <canvas id="barChart"></canvas>
        </div>
    </div>

    <script>
        new Chart(document.getElementById("barChart"), {
            type: "bar",
            data: {
                labels: ["Resume Skills", "GitHub Skills"],
                datasets: [{
                    label: 'Number of Skills',
                    data: [{{ resume_skills| length }}, {{ github_languages| length }}],
            backgroundColor: ['#4e73df', '#1cc88a']
        }]
    },
            options: {
            responsive: true,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        stepSize: 1
                    }
                }
            }
        }
});
    </script>
    {% endif %}


</body>

</html>